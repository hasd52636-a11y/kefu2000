<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>浏览器状态检查</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }
        .section h2 {
            margin-top: 0;
            color: #333;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0069d9;
        }
        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>浏览器状态检查工具</h1>
        
        <div class="section">
            <h2>1. 基本信息</h2>
            <div id="basic-info"></div>
        </div>
        
        <div class="section">
            <h2>2. 缓存状态</h2>
            <button onclick="checkCache()">检查缓存</button>
            <button onclick="clearCache()">清除缓存</button>
            <div id="cache-info"></div>
        </div>
        
        <div class="section">
            <h2>3. Service Worker</h2>
            <button onclick="checkServiceWorker()">检查Service Worker</button>
            <button onclick="unregisterServiceWorker()">注销Service Worker</button>
            <div id="sw-info"></div>
        </div>
        
        <div class="section">
            <h2>4. 网络状态</h2>
            <button onclick="checkNetwork()">检查网络</button>
            <div id="network-info"></div>
        </div>
        
        <div class="section">
            <h2>5. 应用状态</h2>
            <button onclick="checkApp()">检查应用</button>
            <div id="app-info"></div>
        </div>
    </div>
    
    <script>
        // 基本信息
        function showBasicInfo() {
            const info = {
                browser: navigator.userAgent,
                language: navigator.language,
                online: navigator.onLine,
                cookiesEnabled: navigator.cookieEnabled,
                storage: {
                    localStorage: typeof localStorage !== 'undefined',
                    sessionStorage: typeof sessionStorage !== 'undefined'
                }
            };
            
            const html = `
                <div class="status ${info.online ? 'success' : 'error'}">在线状态: ${info.online ? '在线' : '离线'}</div>
                <div class="status success">浏览器: ${info.browser}</div>
                <div class="status success">语言: ${info.language}</div>
                <div class="status ${info.cookiesEnabled ? 'success' : 'error'}">Cookies: ${info.cookiesEnabled ? '启用' : '禁用'}</div>
                <div class="status ${info.storage.localStorage ? 'success' : 'error'}">LocalStorage: ${info.storage.localStorage ? '可用' : '不可用'}</div>
                <div class="status ${info.storage.sessionStorage ? 'success' : 'error'}">SessionStorage: ${info.storage.sessionStorage ? '可用' : '不可用'}</div>
            `;
            
            document.getElementById('basic-info').innerHTML = html;
        }
        
        // 检查缓存
        function checkCache() {
            const info = document.getElementById('cache-info');
            info.innerHTML = '<div class="status warning">检查中...</div>';
            
            // 检查本地存储
            let localStorageSize = 0;
            if (typeof localStorage !== 'undefined') {
                for (let key in localStorage) {
                    if (localStorage.hasOwnProperty(key)) {
                        localStorageSize += localStorage[key].length;
                    }
                }
            }
            
            setTimeout(() => {
                const html = `
                    <div class="status success">LocalStorage 大小: ${(localStorageSize / 1024).toFixed(2)} KB</div>
                    <div class="status success">缓存检查完成</div>
                `;
                info.innerHTML = html;
            }, 1000);
        }
        
        // 清除缓存
        function clearCache() {
            const info = document.getElementById('cache-info');
            info.innerHTML = '<div class="status warning">清除中...</div>';
            
            try {
                // 清除本地存储
                if (typeof localStorage !== 'undefined') {
                    localStorage.clear();
                }
                
                // 清除会话存储
                if (typeof sessionStorage !== 'undefined') {
                    sessionStorage.clear();
                }
                
                setTimeout(() => {
                    const html = `
                        <div class="status success">LocalStorage 已清除</div>
                        <div class="status success">SessionStorage 已清除</div>
                        <div class="status success">缓存清除完成</div>
                    `;
                    info.innerHTML = html;
                }, 1000);
            } catch (error) {
                info.innerHTML = `<div class="status error">清除缓存失败: ${error.message}</div>`;
            }
        }
        
        // 检查Service Worker
        function checkServiceWorker() {
            const info = document.getElementById('sw-info');
            info.innerHTML = '<div class="status warning">检查中...</div>';
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    let html = '';
                    
                    if (registrations.length > 0) {
                        html = '<div class="status error">发现Service Worker注册:</div>';
                        registrations.forEach((reg, index) => {
                            html += `<div class="status warning">${index + 1}. 作用域: ${reg.scope}</div>`;
                        });
                    } else {
                        html = '<div class="status success">未发现Service Worker注册</div>';
                    }
                    
                    info.innerHTML = html;
                }).catch(error => {
                    info.innerHTML = `<div class="status error">检查失败: ${error.message}</div>`;
                });
            } else {
                info.innerHTML = '<div class="status success">浏览器不支持Service Worker</div>';
            }
        }
        
        // 注销Service Worker
        function unregisterServiceWorker() {
            const info = document.getElementById('sw-info');
            info.innerHTML = '<div class="status warning">注销中...</div>';
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    let count = 0;
                    
                    registrations.forEach(reg => {
                        reg.unregister();
                        count++;
                    });
                    
                    setTimeout(() => {
                        const html = `
                            <div class="status success">已注销 ${count} 个Service Worker</div>
                            <div class="status success">Service Worker注销完成</div>
                        `;
                        info.innerHTML = html;
                    }, 1000);
                }).catch(error => {
                    info.innerHTML = `<div class="status error">注销失败: ${error.message}</div>`;
                });
            } else {
                info.innerHTML = '<div class="status success">浏览器不支持Service Worker</div>';
            }
        }
        
        // 检查网络
        function checkNetwork() {
            const info = document.getElementById('network-info');
            info.innerHTML = '<div class="status warning">检查中...</div>';
            
            fetch('http://localhost:3000/')
                .then(response => {
                    const html = `
                        <div class="status ${response.ok ? 'success' : 'error'}">本地服务器: ${response.ok ? '在线' : '离线'}</div>
                        <div class="status success">响应状态: ${response.status}</div>
                    `;
                    info.innerHTML = html;
                })
                .catch(error => {
                    info.innerHTML = `<div class="status error">网络检查失败: ${error.message}</div>`;
                });
        }
        
        // 检查应用
        function checkApp() {
            const info = document.getElementById('app-info');
            info.innerHTML = '<div class="status warning">检查中...</div>';
            
            fetch('http://localhost:3000/index.html')
                .then(response => response.text())
                .then(html => {
                    const hasRoot = html.includes('id="root"');
                    const hasScript = html.includes('src="/index.tsx"');
                    
                    const appHtml = `
                        <div class="status ${hasRoot ? 'success' : 'error'}">Root元素: ${hasRoot ? '存在' : '不存在'}</div>
                        <div class="status ${hasScript ? 'success' : '